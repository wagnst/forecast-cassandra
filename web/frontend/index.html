<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>FourSchlag WS Client</title>
    <link rel="stylesheet" type="text/css" media="screen"
          href="css/jquery-ui-custom.css"/>
    <link rel="stylesheet" type="text/css" media="screen"
          href="css/ui.jqgrid.css">
    <link rel="stylesheet" type="text/css" media="screen"
          href="css/ui.multiselect.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <script src="js/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="js/jquery.jqGrid.min.js" type="text/javascript"></script>
    <script src="js/i18n/grid.locale-en.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
    <script>
        $(function () {
            $.fn.runGrid = function (kpiType, year, period, currency) {
                //set the http endpoint url
                var endpointScheme = 'http://'
                var endpointUrl = '141.19.145.133:8080'
                var endpointPath = '/fourschlag/api/forecast/' + kpiType + '/'
                $("#resultList").jqGrid({
                    url: endpointScheme + endpointUrl + endpointPath + year + '/' + period + '/' + currency,
                    datatype: "json",
                    colNames: ['ORDER_NUMBER', 'KPI', 'M01', 'M02', 'M03', 'M04', 'M05', 'M06', 'M07', 'M08', 'M09', 'M10', 'M11',
                        'M12', 'M13', 'M14', 'M15', 'M16', 'M17', 'M18', 'BJ2', 'BJ3', 'BJ4', 'REGION', 'SUBREGION', 'SBU', 'ENTRY_TYPE',
                        'PRODUCT_MAIN_GROUP', 'SALES_TYPE', 'CURRENCY', 'UNIT', 'FC_TYPE'
                    ],
                    colModel: [{
                        name: 'orderNumber',
                        width: 55,
                        align: "left"
                    }, {
                        name: 'kpi',
                        width: 70,
                        align: "left"
                    }, {
                        name: 'm01',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm02',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm03',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm04',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm05',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm06',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm07',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm08',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm09',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm10',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm11',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm12',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm13',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm14',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm15',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm16',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm17',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'm18',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'bj2',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'bj3',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'bj4',
                        width: 40,
                        align: "right"
                    }, {
                        name: 'region',
                        width: 75,
                        align: "left"
                    }, {
                        name: 'subregion',
                        width: 75,
                        align: "left"
                    }, {
                        name: 'sbu',
                        width: 50,
                        align: "left"
                    }, {
                        name: 'entryType',
                        width: 30,
                        align: "left"
                    }, {
                        name: 'productMainGroup',
                        width: 80,
                        align: "left"
                    }, {
                        name: 'salesType',
                        width: 55,
                        align: "left"
                    }, {
                        name: 'currency',
                        width: 30,
                        align: "left"
                    }, {
                        name: 'unit',
                        width: 30,
                        align: "left"
                    }, {
                        name: 'fcType',
                        width: 30,
                        align: "left"
                    }
                    ],
                    rowNum: 780,
                    rowList: [780],
                    pager: '#resultPager',
                    sortname: 'region',
                    sortorder: "desc",
                    viewrecords: true,
                    multiselect: false,
                    height: '100%',
                });
                $("#resultList").jqGrid('navGrid', '#resultPager', {
                    edit: false,
                    add: false,
                    del: false
                });
                $("#resultList").parents('div.ui-jqgrid-bdiv').css("min-height", "100px");
                //trigger for refresh
                $("#resultList").jqGrid().setGridParam({url: endpointScheme + endpointUrl + endpointPath + year + '/' + period + '/' + currency}).trigger("reloadGrid")
            }

            // listener on submit input form
            $('#inputForm').submit(function (e) {
                // to stop the form from submitting
                e.preventDefault();
                var data = $("#inputForm :input").serializeArray();
                var kpiType = $('#kpiType').find(":selected").text();
                console.log("querying for kpiType=" + kpiType + ", year=" + data[0].value + ", period=" + data[1].value + ", currency=" + data[2].value);
                $("#resultList").jqGrid("clearGridData");
                $.fn.runGrid(kpiType, data[0].value, data[1].value, data[2].value);
                console.log("query done");
            });
        });
    </script>
</head>

<body>


<div class="panel panel-default">
    <div class="panel-heading">FourSchlag JS Sample Frontend</div>
    <div class="panel-body">
        <div class="jumbotron">
            <form id="inputForm" class="form-horizontal" role="form">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xs-12 col-md-2">
                            <div class="form-group">
                                <label class="col-lg-3 control-label"
                                       for="kpiType">Area</label>
                                <div class="col-lg-8">
                                    <select class="form-control" id="kpiType">
                                        <option>sales</option>
                                    </select>
                                </div>
                            </div>

                        </div>
                        <div class="col-xs-12 col-md-2">
                            <div class="form-group">
                                <label class="col-lg-3 control-label"
                                       for="year">Year</label>
                                <div class="col-lg-8">
                                    <input type="text" class="form-control"
                                           name="year"
                                           value="2013">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-lg-3 control-label"
                                       for="period">Period</label>
                                <div class="col-lg-8">
                                    <input type="text" class="form-control"
                                           name="period"
                                           value="201611">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-lg-3 control-label"
                                       for="currency">Currency</label>
                                <div class="col-lg-8">
                                    <input type="text" class="form-control"
                                           name="currency"
                                           value="eur">
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-1">
                            <div class="form-group">
                                <label class="col-lg-2 control-label"
                                       for=""></label>
                                <div class="col-lg-2">
                                    <button type="submit"
                                            class="btn btn-default"><img
                                            width="120px"
                                            height="120px"
                                            src="img/fourschlag-logo.png"/>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <table id="resultList"></table>
        <div id="resultPager"></div>
    </div>
</div>

</body>

</html>
